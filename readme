Feature Set
===========

Propel Organization Data
- Organizations are stored as the 'propel_org' custom post type
- propel_orgs have a hierarchy and can belong to other propel_orgs
- propel_orgs have a special 'org_type' taxonomy to label relationships like 'Team' or 'League'
- propel_orgs have a 'org_id' post_meta


Selecting an Propel Organization
- A user has a user_meta for each 'propel_org' they belong to
- The user's org relationships can be selected on several 'Edit User' pages
  - /wp-admin/user-edit.php
  - /wp-admin/user-new.php
  - /wp-admin/profile.php
- The user's org relationships can also be selected according to different actions
  - userpro_before_form_submit
    -- /profile/register/
  - woocommerce_after_checkout_billing_form
    -- /checkout/


User Stories
============

Here is a set of user tracks this plugin covers:


USERPRO [Public, you should NOT see 'draft' orgs]

- New User User Pro Registration, select League and Team
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Select a currently available League and Team (don't create a new one)
  - Click the Register button
  - propel_okm_org_id and propel_org_team both equal 3273

  + 2015-03-04 15:29:46

- New User User Pro Registration, select League and create a new Team
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Select a currently available League and create a new Team
  - Click the Register button
  - propel_okm_org_id and propel_org_team both equal 3385

  + 2015-03-04 15:31:58

- New User User Pro Registration, select League with no Team (should make League propel_okm_org_id)
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Select a currently available League with no team
  - Click the Register button
  - propel_okm_org_id and propel_org_league both equal 3256, (made propel_org_team but empty? >:{ )

  + 2015-03-04 15:50:40

- New User User Pro Registration, create League with no Team (should make League propel_okm_org_id)
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Create a League with no team
  - Click the Register button
  - propel_okm_org_id and propel_org_league both equal 3397, no propel_org_team

  + 2015-03-04 16:09:20

- New User User Pro Registration, create League and create Team
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Create a League and create a Team
  - Click the Register button
  - propel_okm_org_id and propel_org_league both equal 3399

  + 2015-03-04 16:16:01

- New User User Pro Registration, no League and no Team
  - Click [Activate your Key](http://strokeandturn.dev/activate-key/)
  - Complete registration
  - Select no League and no Team
  - Click the Register button
  - Should not have propel_okm_org_id, propel_org_league or propel_org_team

  + 2015-03-04 16:20:27 - @TODO Creates empty propel_okm_org_id and propel_org_league user_meta records


WOOCOMMERCE [Public, you should NOT see 'draft' orgs]

- New User Registration during WooCommerce Purchase, select League (no org_id) and Team
  - Add a key to the cart
  - During checkout, create a new user
  - Select a currently available League and Team (don't create a new one)
  - Enter CC information and purchase
  - propel_okm_org_id and propel_org_team both equal 3015

- New User Registration during WooCommerce Purchase, select League and create a new Team
  - Add a key to the cart
  - During checkout, create a new user
  - Select a currently available League and create a new Team
  - Enter CC information and purchase
  - propel_okm_org_id and propel_org_team both equal 3392

- New User Registration during WooCommerce Purchase, select League (with org_id) and no Team
  - Add a key to the cart
  - During checkout, create a new user
  - Select a currently available League (one with an org_id) and don't select a Team
  - Enter CC information and purchase

  √ propel_okm_org_id and propel_org_league both equal 3405
  √ Keys appear in OKM under org_id 14 (League org_id)

  + 2015-03-10 15:53:32 caseypatrickdriscoll
  + 2015-03-10 16:39:32 caseypatrickdriscoll

- New User Registration during WooCommerce Purchase, select League (with org_id) and create new Team
  - Add a key to the cart
  - During checkout, create a new user
  - Select a currently available League (one with an org_id) and create a new Team
  - Enter CC information and purchase

  √ propel_okm_org_id and propel_org_league both equal 3405
  √ New propel_org_team with unique ID 3423
  √ Keys appear in OKM under org_id 14 (League org_id)

  + 2015-03-10 16:36:18 caseypatrickdriscoll



WP-ADMIN [Private, you SHOULD see 'draft' orgs]

/wp-admin/user-edit.php

- User Edit, select League and Team
  - Go to /wp-admin/users.php and select a user to edit
  - Select a currently available League and Team (don't create a new one)
  - Update User

- User Edit, select League and create a new Team
  - Go to /wp-admin/users.php and select a user to edit
  - Select a currently available League and create a new Team
  - Update User

/wp-admin/profile.php

- User Edit, select League and Team
  - Go to /wp-admin/users.php and select a user to edit
  - Select a currently available League and Team (don't create a new one)
  - Update User

- User Edit, select League and create a new Team
  - Go to /wp-admin/users.php and select a user to edit
  - Select a currently available League and create a new Team
  - Update User





TODO:
=====

- Add remove button for 'new_propel_org_' fields
- Adding a new org, but org name already exists (with or without parent) (should we overwrite or notify user?)
- Need to consider is/isnt org_admin for League/Team selection
- Make sure saving appropriate propel_org_xxxxx to propel_okm_org_id (team, leagure, or none at all)
- UserPro adds propel_org_team if created league with no team

